<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Login</title>
</head>
<body>

<script>
  if (localStorage.getItem("token")) {
    window.location.href = "/html/index.html"
  }
</script>

<h1>Login</h1>

<form id="login-form">
  <input type="email" id="email" placeholder="Email" required>
  <input type="password" id="password" placeholder="Senha" required>
  <button type="submit">Entrar</button>
</form>

<script>
  document.getElementById("login-form").addEventListener("submit", async e => {
    e.preventDefault()

    const email = email.value
    const senha = password.value

    const res = await fetch("/login", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ email, senha })
    })

    const data = await res.json()

    if (!res.ok) {
      alert(data.error)
      return
    }

    localStorage.setItem("token", data.token)
    window.location.href = "/html/index.html"
  })
</script>

</body>
</html>
